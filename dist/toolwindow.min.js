"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function n(h,_,r){function a(i,t){if(!_[i]){if(!h[i]){var s="function"==typeof require&&require;if(!t&&s)return s(i,!0);if(l)return l(i,!0);var e=new Error("Cannot find module '"+i+"'");throw e.code="MODULE_NOT_FOUND",e}var o=_[i]={exports:{}};h[i][0].call(o.exports,function(t){return a(h[i][1][t]||t)},o,o.exports,n,h,_,r)}return _[i].exports}for(var l="function"==typeof require&&require,t=0;t<r.length;t++)a(r[t]);return a}({1:[function(t,i,s){window.ToolWindow=t("./lib/toolwindow").ToolWindow},{"./lib/toolwindow":2}],2:[function(t,i,s){var e={title:"Tool Window",closeButtonText:"âœ–",buttons:[{text:"Ok",clicked:function(){this.hide()}}],minWidth:200,minHeight:200,width:350,height:200,minZIndex:1e3,top:void 0,left:void 0,resizeHandleSize:10,content:{type:"text",value:""}},o=1e3;function n(t){this._options=Object.assign({},e,t||{}),this._options.minZIndex>o&&(o=this._options.minZIndex),this._minW=this._options.minWidth,this._minH=this._options.minHeight,this._options.width<this._minW&&(this._options.width=this._minW),this._options.height<this._minH&&(this._options.height=this._minH),this._resizePixel=this._options.resizeHandleSize,this._hasEventListeners=!!window.addEventListener,this._isDrag=!1,this._isResize=!1,this._isButton=!1,this._resizeMode="",this._initialPlacementDone=!1,this._createDialogStructure(),this._bindMouseEvents(),this._minW=Math.max(this._minW,84*(this._buttons.length-1)+13),this._minW=Math.max(this._minW,84*(this._buttons.length-1)+13)}n.prototype={show:function(){this._dialog.style.display="block";var t=this._buttons[this._buttons.length-1];if(t&&t.focus(),!this._initialPlacementDone){var i=void 0===this._options.left?(window.innerWidth-this._options.width)/2:this._options.left,s=void 0===this._options.top?(window.innerHeight-this._options.height)/2:this._options.top;this._initialPlacementDone=!0,this.moveTo(i,s,this._options.width,this._options.height)}this.refresh()},hide:function(){this._dialog.style.display="none"},refresh:function(){var i=this;if(this._options.content)switch(this._options.content.type){case"text":this._fetchContent(function(t){return i._dialogContent.innerText=t});break;case"html":case"text/html":this._fetchContent(function(t){return i._dialogContent.innerHTML=t});break;case"url":var s=this._dialogContent.querySelector("iframe");s||(s=this._mkEl("iframe","content-iframe",this._dialogContent)),this._fetchContent(function(t){s.src===t?(s.src="about:blank",window.setTimeout(function(){s.src=t},0)):s.src=t});break;default:throw new Error("Content type not handled: "+(this._options.content.type||"(not set)"))}else this._dialogContent.innerText="No content defined"},_fetchContent:function(i){if("function"==typeof this._options.content.value){var t=this._options.content.value();"function"==typeof t.then?t.then(function(t){i(t)}):i(t)}else i(this._options.content.value)},_createDialog:function(){this._dialog=this._mkDiv("dialog",document.body),this._dialog.style.width=this._px(this._options.width),this._dialog.style.height=this._px(this._options.height),this._dialog.style.display="none",this._dialog.style.zIndex=(++o).toString()},_createTitlebar:function(){this._dialogTitle=this._mkDiv("titlebar",this._dialog),this._dialogTitle.innerText=this._options.title,this._closeButton=this._mkEl("button","close",this._dialogTitle),this._closeButton.innerText=this._options.closeButtonText,this._closeButton.addEventListener("click",this.hide.bind(this))},_createContentArea:function(){this._dialogContent=this._mkDiv("content",this._dialog),this._coverContentDuringMoveAndResize="url"===this._options.content.type},_createButtonBar:function(){var s=this;this._buttonBar=this._mkDiv("button-bar",this._dialog),this._buttons=this._options.buttons.map(function(i){var t=s._mkEl("button","dialog-button",s._buttonBar);t.innerText=i.text,i.clicked&&t.addEventListener("click",function(t){i.clicked.apply(s,t)})})},_createGrippers:function(){this._mkDiv(["gripper","left"],this._dialog),this._mkDiv(["gripper","right"],this._dialog)},_createDialogStructure:function(){this._createDialog(),this._createTitlebar(),this._createContentArea(),this._createButtonBar(),this._createGrippers()},_bindMouseEvents:function(){this._setDialogContentSizing(),this._addEvent(this._dialog,"mousedown",this._onMouseDown.bind(this)),this._addEvent(document,"mousemove",this._onMouseMove.bind(this)),this._addEvent(document,"mouseup",this._onMouseUp.bind(this))},_raiseDialog:function(){this._dialog.style.zIndex=(++o).toString()},_px:function(t){return(t=(t||"0")+"").match(/px$/)?t:t+"px"},_mkDiv:function(t,i){return this._mkEl("div",t,i)},_mkEl:function(t,i,s){var e=document.createElement(t);return i&&(Array.isArray(i)||(i=[i]),i.forEach(function(t){e.classList.add(t)})),s&&s.appendChild(e),e},_addEvent:function(t,i,s){null!=t&&void 0!==(void 0===t?"undefined":_typeof(t))&&(this._hasEventListeners?t.addEventListener(i,s,!1):t.attachEvent?t.attachEvent("on"+i,s):t["on"+i]=s)},_returnEvent:function(t){if(t.stopPropagation&&t.stopPropagation(),!t.preventDefault)return t.returnValue=!1;t.preventDefault()},_onMouseDown:function(t){if(this._raiseDialog(),(t=t||window.event)&&t.target){var i=this._getOffset(this._dialog);return this._maxX=Math.max(document.documentElement.clientWidth,document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth),this._maxY=Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight),i.right>this._maxX&&(this._maxX=i.right),i.bottom>this._maxY&&(this._maxY=i.bottom),this._startX=t.pageX,this._startY=t.pageY,this._startW=this._dialog.clientWidth,this._startH=this._dialog.clientHeight,this._leftPos=i.left,this._topPos=i.top,t.target===this._dialogTitle&&""===this._resizeMode?(this._setCursor("move"),this._isDrag=!0):""!==this._resizeMode&&(this._isResize=!0),this._coverContentDuringMoveAndResize&&this._createContentCover(),this._returnEvent(t)}},_createContentCover:function(){this._contentCover&&this._contentCover.remove(),this._contentCover=this._mkDiv(void 0,this._dialog),this._fitContentCoverOverContent()},_fitContentCoverOverContent:function(){if(this._contentCover){var t=this._contentCover.style,i=this._dialogContent.getBoundingClientRect(),s=this._dialogTitle.getBoundingClientRect();t.width=this._px(i.width),t.height=this._px(i.height),t.top=this._px(s.height),t.left="0px",t.position="absolute",t.background="transparent",t.zIndex="9999"}},_removeContentCover:function(){this._contentCover&&this._contentCover.remove(),this._contentCover=void 0},moveTo:function(t,i,s,e){void 0!==t&&(this._dialog.style.left=this._px(t)),void 0!==i&&(this._dialog.style.top=this._px(i)),this.resizeTo(s,e)},_doDrag:function(t){var i=this._startX-t.pageX,s=this._startY-t.pageY,e=this._leftPos-i,o=this._topPos-s,n=Math.max(document.body.scrollLeft,document.documentElement.scrollLeft),h=Math.max(document.body.scrollTop,document.documentElement.scrollTop);i<0&&e+this._startW>this._maxX&&(e=this._maxX-this._startW),0<i&&e<0&&(e=0),s<0&&o+this._startH>this._maxY&&(o=this._maxY-this._startH),0<s&&o<0&&(o=0),this.moveTo(e,o),t.clientY>window.innerHeight-32?h+=32:t.clientY<32&&(h-=32),t.clientX>window.innerWidth-32?n+=32:t.clientX<32&&(n-=32),o+this._startH===this._maxY?h=this._maxY-window.innerHeight+20:0===o&&(h=0),e+this._startW===this._maxX?n=this._maxX-window.innerWidth+20:0===e&&(n=0),this._startH>window.innerHeight&&(h=t.clientY<window.innerHeight/2?0:this._maxY-window.innerHeight+20),this._startW>window.innerWidth&&(n=t.clientX<window.innerWidth/2?0:this._maxX-window.innerWidth+20),window.scrollTo(n,h)},resizeTo:function(t,i){void 0!==t&&(this._dialog.style.width=this._px(t)),void 0!==i&&(this._dialog.style.height=this._px(i)),this._fitContentCoverOverContent()},_doResize:function(t){var i=void 0,s=void 0,e=void 0,o=void 0;"w"===this._resizeMode?(i=this._startX-t.pageX,this._leftPos-i<0&&(i=this._leftPos),(e=this._startW+i)<this._minW&&(i=(e=this._minW)-this._startW),this.resizeTo(e),this.moveTo(this._leftPos-i)):"e"===this._resizeMode?(i=t.pageX-this._startX,this._leftPos+this._startW+i>this._maxX&&(i=this._maxX-this._leftPos-this._startW),(e=this._startW+i)<this._minW&&(e=this._minW),this.resizeTo(e)):"n"===this._resizeMode?(s=this._startY-t.pageY,this._topPos-s<0&&(s=this._topPos),(o=this._startH+s)<this._minH&&(s=(o=this._minH)-this._startH),this.resizeTo(void 0,o),this.moveTo(void 0,this._topPos-s)):"s"===this._resizeMode?(s=t.pageY-this._startY,this._topPos+this._startH+s>this._maxY&&(s=this._maxY-this._topPos-this._startH),(o=this._startH+s)<this._minH&&(o=this._minH),this.resizeTo(void 0,o)):"nw"===this._resizeMode?(i=this._startX-t.pageX,s=this._startY-t.pageY,this._leftPos-i<0&&(i=this._leftPos),this._topPos-s<0&&(s=this._topPos),e=this._startW+i,o=this._startH+s,e<this._minW&&(i=(e=this._minW)-this._startW),o<this._minH&&(s=(o=this._minH)-this._startH),this.resizeTo(e,o),this.moveTo(this._leftPos-i,this._topPos-s)):"sw"===this._resizeMode?(i=this._startX-t.pageX,s=t.pageY-this._startY,this._leftPos-i<0&&(i=this._leftPos),this._topPos+this._startH+s>this._maxY&&(s=this._maxY-this._topPos-this._startH),e=this._startW+i,o=this._startH+s,e<this._minW&&(i=(e=this._minW)-this._startW),o<this._minH&&(o=this._minH),this.resizeTo(e,o),this.moveTo(this._leftPos-i)):"ne"===this._resizeMode?(i=t.pageX-this._startX,s=this._startY-t.pageY,this._leftPos+this._startW+i>this._maxX&&(i=this._maxX-this._leftPos-this._startW),this._topPos-s<0&&(s=this._topPos),e=this._startW+i,o=this._startH+s,e<this._minW&&(e=this._minW),o<this._minH&&(s=(o=this._minH)-this._startH),this.resizeTo(e,o),this.moveTo(void 0,this._topPos-s)):"se"===this._resizeMode&&(i=t.pageX-this._startX,s=t.pageY-this._startY,this._leftPos+this._startW+i>this._maxX&&(i=this._maxX-this._leftPos-this._startW),this._topPos+this._startH+s>this._maxY&&(s=this._maxY-this._topPos-this._startH),e=this._startW+i,o=this._startH+s,e<this._minW&&(e=this._minW),o<this._minH&&(o=this._minH),this.resizeTo(e,o)),this._setDialogContentSizing()},_onMouseMove:function(t){if((t=t||window.event)&&t.target){if(this._isDrag)this._doDrag(t);else if(this._isResize)this._doResize(t);else if(!this._isButton){var i=void 0,s="";if(t.target===this._dialog||t.target===this._dialogTitle||this._dialog.contains(t.target)){var e=this._getOffset(this._dialog);t.pageY<e.top+this._resizePixel?s="n":t.pageY>e.bottom-this._resizePixel&&(s="s"),t.pageX<e.left+this._resizePixel?s+="w":t.pageX>e.right-this._resizePixel&&(s+="e")}""!==s&&this._resizeMode!==s?("n"===s||"s"===s?i="ns-resize":"e"===s||"w"===s?i="ew-resize":"ne"===s||"sw"===s?i="nesw-resize":"nw"!==s&&"se"!==s||(i="nwse-resize"),this._setCursor(i),this._resizeMode=s):""===s&&""!==this._resizeMode&&(this._setCursor(""),this._resizeMode="")}return this._returnEvent(t)}},_onMouseUp:function(t){return t=t||window.event,this._isDrag?(this._setCursor(""),this._isDrag=!1):this._isResize?(this._setCursor(""),this._isResize=!1,this._resizeMode=""):this._isButton&&(this._isButton=!1),this._removeContentCover(),this._returnEvent(t)},_getOffset:function(t){var i=t.getBoundingClientRect(),s=window.scrollX||document.documentElement.scrollLeft,e=window.scrollY||document.documentElement.scrollTop;return{left:i.left+s,top:i.top+e,right:i.right+s,bottom:i.bottom+e}},_setCursor:function(t){this._dialog.style.cursor=t,this._dialogTitle.style.cursor=t},_setDialogContentSizing:function(){}},i.exports={ToolWindow:n}},{}]},{},[1]);